<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Bundle Minifier Test Page</title>
    
    <!-- External CSS Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    
    <!-- Local CSS Files -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Inline Styles with @import -->
    <style>
        /* Import external styles for testing @import functionality */
        @import url('css/imported-styles.css');
        
        /* Remaining inline critical styles */
        .test-import-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }
        
        .test-import-indicator::before {
            content: '✓ @import working';
        }
    </style>
</head>
<body>
    <!-- Visual indicator that @import is working -->
    <div class="test-import-indicator"></div>
    
    <header>
        <h1>HTML Bundle Minifier Test Page</h1>
        <nav>
            <ul>
                <li><a href="#features">Features</a></li>
                <li><a href="#demo">Demo</a></li>
                <li><a href="#test-results">Test Results</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="features">
            <h2><i class="fas fa-tools"></i> Features Being Tested</h2>
            <div class="row">
                <div class="col-md-3">
                    <div class="enhanced-card">
                        <h3><i class="fab fa-css3-alt text-primary"></i> CSS Handling</h3>
                        <p>Tests inline styles, local CSS files, and external CDN libraries.</p>
                        <div class="badge bg-success">Enhanced</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="enhanced-card">
                        <h3><i class="fab fa-js-square text-warning"></i> JavaScript Processing</h3>
                        <p>Handles inline scripts, local JS files, and external libraries.</p>
                        <div class="badge bg-info">Interactive</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="enhanced-card">
                        <h3><i class="fas fa-compress-alt text-danger"></i> Minification</h3>
                        <p>Compresses HTML, CSS, and JavaScript for optimal performance.</p>
                        <div class="badge bg-primary">Optimized</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="enhanced-card">
                        <h3><i class="fas fa-layer-group text-success"></i> Bundling</h3>
                        <p>Combines multiple resources into a single optimized file.</p>
                        <div class="badge bg-secondary">Bundled</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="demo">
            <h2><i class="fas fa-play-circle"></i> Interactive Demo</h2>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="enhanced-card">
                            <h3><i class="fas fa-keyboard"></i> Text Processor</h3>
                            <div class="mb-3">
                                <label for="text-input" class="form-label">Enter some text:</label>
                                <input type="text" id="text-input" class="form-control" placeholder="Type something here...">
                            </div>
                            <button id="process-btn" class="glow-button pulse">
                                <i class="fas fa-magic"></i> Process Text
                            </button>
                            
                            <div class="mt-3">
                                <h4>Output:</h4>
                                <div id="output" class="alert alert-success">
                                    Your processed text will appear here...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6">
                        <div class="enhanced-card">
                            <h3><i class="fas fa-palette"></i> Dynamic Chart Demo</h3>
                            <div class="chart-container">
                                <canvas id="myChart" width="400" height="200"></canvas>
                            </div>
                            <button id="update-chart" class="btn btn-primary">
                                <i class="fas fa-refresh"></i> Update Chart
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="test-results">
            <h2><i class="fas fa-chart-line"></i> Test Results</h2>
            <div class="row">
                <div class="col-md-4">
                    <div class="enhanced-card text-center">
                        <i class="fas fa-file-code fa-2x text-primary mb-2"></i>
                        <h4>Original Size</h4>
                        <span id="original-size" class="h3 text-success">Calculating...</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="enhanced-card text-center">
                        <i class="fas fa-compress fa-2x text-warning mb-2"></i>
                        <h4>Minified Size</h4>
                        <span id="minified-size" class="h3 text-info">Run minifier to see</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="enhanced-card text-center">
                        <i class="fas fa-percentage fa-2x text-danger mb-2"></i>
                        <h4>Compression Ratio</h4>
                        <span id="compression-ratio" class="h3 text-dark">Run minifier to see</span>
                    </div>
                </div>
            </div>
            
            <div class="enhanced-card mt-4">
                <h3><i class="fas fa-list-ol"></i> How to Test:</h3>
                <ol class="list-group list-group-numbered">
                    <li class="list-group-item">Save this file as test.html</li>
                    <li class="list-group-item">Run the minifier: <code class="bg-light p-1 rounded">npm run</code></li>
                    <li class="list-group-item">When prompted, enter the path to this file</li>
                    <li class="list-group-item">Check the generated .min.html file</li>
                    <li class="list-group-item">Compare file sizes and functionality</li>
                    <li class="list-group-item"><strong>@import Test:</strong> Verify that styles from <code>css/imported-styles.css</code> are properly bundled</li>
                </ol>
                
                <div class="alert alert-info mt-3">
                    <h5><i class="fas fa-info-circle"></i> @Import Test Features:</h5>
                    <ul class="mb-0">
                        <li>CSS @import statement in inline styles</li>
                        <li>External CSS file with extracted styles</li>
                        <li>Visual indicator showing @import is working</li>
                        <li>JavaScript module importing with utility functions</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-dark text-light py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <p><i class="fas fa-copyright"></i> 2025 HTML Bundle Minifier Test. Enhanced testing with multiple resource types.</p>
                </div>
                <div class="col-md-4">
                    <div class="d-flex flex-wrap gap-2">
                        <span class="badge bg-primary">External CSS: 2</span>
                        <span class="badge bg-warning">Local CSS: 2 + @import</span>
                        <span class="badge bg-success">External JS: 2</span>
                        <span class="badge bg-info">Local JS: 2</span>
                        <span class="badge bg-secondary">Elements: <span id="element-count">0</span></span>
                        <span class="badge bg-dark">@import Test: ✓</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- External JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Local JavaScript Files -->
    <script src="js/utils.js"></script>
    <script src="js/imported-utils.js"></script>
    
    <!-- Inline JavaScript -->
    <script>
        // Inline critical JavaScript functionality

        document.addEventListener('DOMContentLoaded', function() {
            console.log('Enhanced HTML Bundle Minifier Test Page loaded!');
            
            // Initialize text processor
            initializeTextProcessor();
            initializeChart();
            updateElementCount();
            
            // Use imported function for page size calculation
            if (window.testUtilities && window.testUtilities.displayPageSize) {
                window.testUtilities.displayPageSize();
            }
        });

        // Simplified text processing
        function initializeTextProcessor() {
            const textInput = document.getElementById('text-input');
            const processBtn = document.getElementById('process-btn');
            const output = document.getElementById('output');
            
            if (processBtn && textInput && output) {
                processBtn.addEventListener('click', function() {
                    const inputText = textInput.value.trim();
                    
                    if (inputText === '') {
                        output.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Please enter some text to process!';
                        output.className = 'alert alert-warning';
                        return;
                    }
                    
                    // Process text: reverse, add timestamp, format
                    const reversed = inputText.split('').reverse().join('');
                    const timestamp = new Date().toLocaleTimeString();
                    const processed = `
                        <strong>Original:</strong> ${inputText}<br>
                        <strong>Reversed:</strong> ${reversed}<br>
                        <strong>Length:</strong> ${inputText.length} characters<br>
                        <strong>Processed at:</strong> ${timestamp}
                    `;
                    
                    output.innerHTML = processed;
                    output.className = 'alert alert-success';
                    
                    // Add animation
                    output.style.transform = 'scale(1.05)';
                    setTimeout(() => {
                        output.style.transform = 'scale(1)';
                    }, 300);
                });
                
                textInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        processBtn.click();
                    }
                });
            }
        }

        // Chart initialization using Chart.js
        let myChart;
        function initializeChart() {
            const ctx = document.getElementById('myChart');
            if (ctx) {
                myChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['CSS Files', 'JS Files', 'Images', 'Other'],
                        datasets: [{
                            data: [3, 3, 0, 1],
                            backgroundColor: [
                                '#FF6B6B',
                                '#4ECDC4',
                                '#45B7D1',
                                '#96CEB4'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            },
                            title: {
                                display: true,
                                text: 'Resource Distribution'
                            }
                        }
                    }
                });
                
                // Update chart button
                const updateBtn = document.getElementById('update-chart');
                if (updateBtn) {
                    updateBtn.addEventListener('click', function() {
                        const newData = [
                            Math.floor(Math.random() * 10) + 1,
                            Math.floor(Math.random() * 10) + 1,
                            Math.floor(Math.random() * 5),
                            Math.floor(Math.random() * 3) + 1
                        ];
                        myChart.data.datasets[0].data = newData;
                        myChart.update();
                    });
                }
            }
        }

        // Element counter
        function updateElementCount() {
            const totalElements = document.querySelectorAll('*').length;
            const elementCountSpan = document.getElementById('element-count');
            if (elementCountSpan) {
                // Animate the count
                let current = 0;
                const increment = totalElements / 50;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= totalElements) {
                        elementCountSpan.textContent = totalElements;
                        clearInterval(timer);
                    } else {
                        elementCountSpan.textContent = Math.floor(current);
                    }
                }, 20);
            }
        }
    </script>
</body>
</html>